version: '2'
services:
    base:
        build: ./Docker
        user: ue4
        environment:
            SteamAppId: "1220770"
            SteamGameId: "1220770"
        volumes:
            - "./Publish/LinuxServer:/home/ue4/CrimsonMirror"
            - "./Docker/steamclient.so:/home/ue4/CrimsonMirror/Engine/Binaries/ThirdParty/Steamworks/Steamv146/x86_64-unknown-linux-gnu/steamclient.so"
        working_dir: "/home/ue4/CrimsonMirror"
    dedicated:
        extends: base
        command: ["./CrimsonMirrorServer.sh", "-log", "-jemalloc"]
        ports:
            - "7777:7777/tcp"
            - "7777:7777/udp"
            - "27016:27016"
    steamcmd:
        extends: base
        tty: true
        stdin_open: true
        command: bash